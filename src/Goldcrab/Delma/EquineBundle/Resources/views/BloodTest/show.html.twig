{% extends '::base.html.twig' %}

{% block body -%}
    <div class="container-fluid">
    <div class="row-fluid">
    <div class="span12">
    <section>

    <ul class="breadcrumb">
        <li><a href="{{ path('delma_home') }}">Dashboard</a> <span class="divider">/</span></li>
        <li><a href="{{ path('test_blood') }}">Blood Test</a> <span class="divider">/</span></li>
        <li class="active">View Test</li>
    </ul>

    <div class="row show-grid">
    <div class="span8 offset2">

    <h4>Blood Test - View</h4>

    {{ include('DelmaEquineBundle::testShowExtras.html.twig') }}

    <p style="padding-left: 50px; margin: 20px 0; font-weight: bold;">Hematology</p>

    <table class="table table-bordered width-80 w-c">
    <tbody>

    <tr>
        <th>WBC</th>
        <th>HCT</th>
        <th>HB</th>
        <th>RBC</th>
        <th>MCV</th>
        <th>MCH</th>
        <th>MCHC</th>
        <th colspan="2">NEUT</th>
        <th colspan="2">LYMPH</th>
        <th colspan="2">MONO</th>
        <th colspan="2">EOSINO</th>
        <th colspan="2">BASO</th>
        <th>BANDS %</th>
        <th>PTP</th>
        <th>FIB</th>
        <th>PLT</th>
    </tr>
    <tr style="font-size: 10px;">
        <td>6 - 12<br />10E9/L</td>
        <td>32 - 48<br />%</td>
        <td>10 - 18<br />g/dL</td>
        <td>6 - 12<br />10E6/UL</td>
        <td>34 - 58<br />FL</td>
        <td>13 - 19<br />Pg</td>
        <td>31 - 37<br />g/gL</td>
        <td>50-60<br />%</td>
        <td>3.0-6-5<br />X10E9/L</td>
        <td>36-48<br />%</td>
        <td>2.0-5.0<br />X10E9/L</td>
        <td>3-6<br />%</td>
        <td>0.2-1.0<br />X10E9/L</td>
        <td>1-2<br />%</td>
        <td>0.1-0.5<br />X10E9/L</td>
        <td>0-1<br />%</td>
        <td>0-0.9<br />X10E9/L</td>
        <td><br />%</td>
        <td>6.0-8.5<br />g/dL</td>
        <td>100-400<br />mg%</td>
        <td>100-350<br />10E9/L</td>
    </tr>
    <tr>
        <td>{{ entity.hWbc }}</td>
        <td>{{ entity.hHct }}</td>
        <td>{{ entity.hHb }}</td>
        <td>{{ entity.hRbc }}</td>
        <td>{{ entity.hMcv }}</td>
        <td>{{ entity.hMch }}</td>
        <td>{{ entity.hMchc }}</td>
        <td>{{ entity.hNeut }}</td>
        <td>{{ entity.hNeut2 }}</td>
        <td>{{ entity.hLymph }}</td>
        <td>{{ entity.hLymph2 }}</td>
        <td>{{ entity.hMono }}</td>
        <td>{{ entity.hMono2 }}</td>
        <td>{{ entity.hEosino }}</td>
        <td>{{ entity.hEosino2 }}</td>
        <td>{{ entity.hBaso }}</td>
        <td>{{ entity.hBaso2 }}</td>
        <td>{{ entity.hBands }}</td>
        <td>{{ entity.hPtp }}</td>
        <td>{{ entity.hHpFib }}</td>
        <td>{{ entity.hPlt }}</td>
    </tr>
    </tbody>
    </table>



    <p style="padding-left: 50px; margin: 20px 0; font-weight: bold;">Chemistry</p>
    <table class="table table-bordered width-80 w-c">
        <tbody>

        <tr>
            <th>AST</th>
            <th>CK</th>
            <th>LDH</th>
            <th>GGT</th>
            <th>ALP</th>
            <th>T. BIL</th>
            <th>STP</th>
            <th>ALB</th>
            <th>CREA</th>
            <th>UN</th>
            <th>GLUC</th>
            <th>D. BIL</th>

            {% if entity.cExtra == true %}
            <th>SAA</th>
            <th>LAC</th>
            <th>TRIG</th>
            <th>IRON</th>
            <th>Troponin</th>
            <th>PHOS</th>
            <th>FOAL</th>
            {% endif %}
        </tr>

        <tr style="font-size: 10px;">
            <td>150-500<br />U/L</td>
            <td>90-350<br />U/L</td>
            <td>160-490<br />U/L</td>
            <td>11-40<br />U/L</td>
            <td>149-395<br />U/L</td>
            <td>0.3-3.0<br />mg/dL</td>
            <td>5.7-7.9<br />g/dL</td>
            <td>2.3-3.9<br />g/dL</td>
            <td>1-3<br />mg/dL</td>
            <td>10-25<br />mg/dL</td>
            <td>50-115<br />mg/dL</td>
            <td><br />mg/dL</td>

            {% if entity.cExtra == true %}
            <td>0-12<br />µg/ml</td>
            <td>1.11-1.78<br />mmol/L</td>
            <td>50-200<br />mg/dL</td>
            <td>14-31<br />µmol/L</td>
            <td>0-0.06<br />ng/ml</td>
            <td>2.5-4.6<br />mg/dL</td>
            <td><br />lgG</td>
            {% endif %}
        </tr>

        <tr>
            <td>{{ entity.cAst }}</td>
            <td>{{ entity.cCk }}</td>
            <td>{{ entity.cLd }}</td>
            <td>{{ entity.cGct }}</td>
            <td>{{ entity.cAlp }}</td>
            <td>{{ entity.cTBil }}</td>
            <td>{{ entity.cStp }}</td>
            <td>{{ entity.cAlb }}</td>
            <td>{{ entity.cCrea }}</td>
            <td>{{ entity.cUn }}</td>
            <td>{{ entity.cGluc }}</td>
            <td>{{ entity.cDBil }}</td>

            {% if entity.cExtra == true %}
            <td>{% if entity.cSaa == -1.0 %} {% else %}{{ entity.cSaa }}{% endif %}</td>
            <td>{% if entity.cLac == -1.0 %} {% else %}{{ entity.cLac }}{% endif %}</td>
            <td>{% if entity.cTrig == -1.0 %} {% else %}{{ entity.cTrig }}{% endif %}</td>
            <td>{% if entity.cIron == -1.0 %} {% else %}{{ entity.cIron }}{% endif %}</td>
            <td>{% if entity.cTroponin == -1.0 %} {% else %}{{ entity.cTroponin }}{% endif %}</td>
            <td>{% if entity.cPhos == -1.0 %} {% else %}{{ entity.cPhos }}{% endif %}</td>
            <td>{% if entity.cFoal == "" %} {% else %}{{ entity.cFoal }}{% endif %}</td>
            {% endif %}
        </tr>


        </tbody>
    </table>

    <p style="padding-left: 50px; margin: 20px 0; font-weight: bold;">Electrolytes</p>
    <div style="background-image: url(""); height: 300px; background-position: right;"></div>

    <table class="table table-bordered width-80 w-c">
        <tbody>
        <tr>

            <th>Na</th>
            <th>K</th>
            <th>Cl</th>
            <th>Bicarb</th>
            <th>Mg</th>
            <th>Ca</th>
            <th>iCa</th>
            <th>pH</th>
            <th>Bun</th>
            <th>Gluc</th>
            <th>Hb</th>
            <th>Hct</th>
        </tr>

        <tr style="font-size: 10px;">
            <td>132-147<br />mmol/L</td>
            <td>2.8-4.7<br />mmol/L</td>
            <td>95-110<br />mmol/L</td>
            <td>20.7-28.9<br />mmol/L</td>
            <td>1.3-3.2<br />mg/dL</td>
            <td>9.1-13.4<br />mg/dL</td>
            <td>1.25-1.75<br />mmol/L</td>
            <td>7.32-7.44</td>
            <td>10-25<br />mg/dL</td>
            <td>50-115<br />mg/dL</td>
            <td>10-18<br />g/dL</td>
            <td>32-48<br />%</td>

        </tr>

        <tr>
            <td>{% if entity.eNa == -1.0 %}&nbsp;{% else %}{{ entity.eNa }}{% endif %}</td>
            <td>{% if entity.eK == -1.0 %} {% else %}{{ entity.eK }}{% endif %}</td>
            <td>{% if entity.eCl == -1.0 %} {% else %}{{ entity.eCl }}{% endif %}</td>
            <td>{% if entity.eBicarb == -1.0 %} {% else %}{{ entity.eBicarb }}{% endif %}</td>
            <td>{% if entity.eMg == -1.0 %} {% else %}{{ entity.eMg }}{% endif %}</td>
            <td>{% if entity.eCa == -1.0 %} {% else %}{{ entity.eCa }}{% endif %}</td>
            <td>{% if entity.eIca == -1.0 %} {% else %}{{ entity.eIca }}{% endif %}</td>
            <td>{% if entity.ePh == -1.0 %} {% else %}{{ entity.ePh }}{% endif %}</td>
            <td>{% if entity.eBun == -1.0 %} {% else %}{{ entity.eBun }}{% endif %}</td>
            <td>{% if entity.eGluc == -1.0 %} {% else %}{{ entity.eGluc }}{% endif %}</td>
            <td>{% if entity.eHb == -1.0 %} {% else %}{{ entity.eHb }}{% endif %}</td>
            <td>{% if entity.eHct == -1.0 %} {% else %}{{ entity.eHct }}{% endif %}</td>
        </tr>
        </tbody>
    </table>
    <div>
        <p style="padding: 10px 0 0 60px;">{{ entity.comments }}</p>
    </div>
    <div  style="padding: 20px 0 0 50px;">
        {% if is_granted("ROLE_SUPER_ADMIN") %}
        <a class="btn btn-primary" href="{{ path('test_blood_edit', { 'id': entity.id }) }}"><i class="icon-edit icon-white"></i> Edit test</a>

        <div class="btn-group">
            <button class="btn btn-info"><i class="icon-envelope icon-white"></i> Email</button>
            <button class="btn btn-info dropdown-toggle" data-toggle="dropdown">
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li> <a onclick="openEmailText('{{ entity.doctor.id }}','{{ entity.doctor.firstname }}');"> Doctor</a></li>
                <li> <a onclick="openEmailText('{{ entity.testedBy.id }}','{{ entity.testedBy.firstname }}');"> Tester</a></li>
                {% if entity.horse.owner %}
                <li> <a onclick="openEmailText('{{ entity.horse.owner.id }}','{{ entity.horse.owner.firstname }}');"> Owner</a></li>
                {% endif %}
                {% if entity.horse.trainer %}
                <li> <a onclick="openEmailText('{{ entity.horse.trainer.id }}','{{ entity.horse.trainer.firstname }}');"> Trainer</a></li>
                {% endif %}
            </ul>
        </div>
        {% endif %}
        <a class="btn btn-info"href="{{ path('test_blood_print', { 'id': entity.id }) }}" onclick="return printPopup(this.href,'test_blood_print_{{ entity.id }}');"><i class="icon-print icon-white"></i> Print</a>
        {% if is_granted("ROLE_SUPER_ADMIN") %}
            <a href="{{ path('test_blood_new') }}" class="btn btn-success"><i class="icon-plus icon-white"></i> New Blood Test</a>
        {% endif %}

    </div>

    <form action="{{ path('test_blood_email') }}" method="post" id="emailTestForm">
        <div id="inline" style="display:none;width:500px;">
            <h2>Email Report</h2>
            <table width="100%" border="0">
                <tr>
                    <td width="30%">To:</td>
                    <td width="70%"><input type="text" id="emailToUser" name="toUser" style="width:80%" class="userAutoCompleteSelector"></td>
                </tr>
                <tr>
                    <td width="30%">Subject:</td>
                    <td width="70%"><input type="text" name="toSubject" value="Blood Test Report"/></td>
                </tr>
                <tr>
                    <td colspan="2">
<textarea style="width:600px;" cols="600" rows="10" name="toBody">
Attached the test report you had requested for.

Regards,
{{ app.user.firstname }}
</textarea>
                    </td>
                </tr>
            </table>
            <input type="hidden" name="emailTestID" value="{{ entity.id }}" />
            <a class="btn btn-info" id="sendTestEmail" ><i class="icon-envelope icon-white"></i> Email</a>
            <a class="btn btn-danger" href="javascript:$.fancybox.close();"><i class="icon-trash icon-white"></i> Close</a>
        </div>
        <script language="javascript">
            function openEmailText(toUserId,toFirstName){
                $("#emailToUser").val(toUserId).trigger("change");
                $.fancybox( '#inline' , {
                    maxWidth	: 800,
                    maxHeight	: 600,
                    fitToView	: true,
                    width		: '70%',
                    height		: '70%',
                    autoSize	: false,
                    closeClick	: false,
                    openEffect	: 'none',
                    closeEffect	: 'none'
                });
                return false;
            }
            $(document).ready(function() {
                $('#sendTestEmail').click(function(){
                    var emailToUser  = $('#emailToUser').select2("val");
                    if(emailToUser.length==0){
                        $("#emailToUser").select2("open");
                        return;
                    }
                    $.fancybox.close();
                    $('#emailTestForm').submit();
                });
            });
        </script>

    </form>

    <hr />
    <div style="padding: 0 40px 20px;">
        <div class="btn"><a href="{{ path('test_blood') }}"><i class="icon-arrow-left"></i> Back to the list</a></div>
        {% if is_granted("ROLE_SUPER_ADMIN") %}
            <div class="pull-right">
                <button class="btn btn-danger" onclick="deleteTest('{{ path('test_blood_delete', { 'id': entity.id }) }}');" type="button"><i class="icon-trash icon-white"></i> Delete</button>
            </div>
        {% endif %}

    </div>


    </div>
    </div>
    </section>
    </div><!--/span-->
    </div><!--/row-->
    </div><!--/.fluid-container-->
{% endblock %}
